<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Thank You â€” ElevateFit</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" />
  <style>
    body {
      font-family: 'Inter', sans-serif;
      background-color: #0b1220;
      color: #f9fafb;
    }
    .card {
      background: #0f1724;
      border: 1px solid #1f2937;
      border-radius: .75rem;
    }
    .btn-primary {
      background-color: #f97316;
      color: white;
      font-weight: 600;
      border-radius: .5rem;
      padding: .6rem 1rem;
    }
    .btn-primary:hover {
      background-color: #ea580c;
    }
  </style>
</head>

<body class="min-h-screen flex items-center justify-center p-6">

  <div class="w-full max-w-2xl card p-8 text-center shadow-lg">
    <i class="fas fa-check-circle text-green-500 text-5xl mb-4"></i>
    <h1 class="text-3xl font-bold mb-2">Payment Successful ðŸŽ‰</h1>
    <p class="text-gray-400 mb-6">Thank you for shopping with <span class="text-orange-500 font-semibold">ElevateFit</span>.  
    Your order has been confirmed.</p>

    <div id="order-summary" class="text-left bg-gray-800 p-4 rounded-lg mb-6">
      <h2 class="font-semibold text-lg mb-3 border-b border-gray-700 pb-2">Order Summary</h2>
      <div id="order-details" class="space-y-2 text-gray-300 text-sm"></div>
    </div>

    <a href="index.html" class="btn-primary inline-block">Continue Shopping</a>
  </div>

  <script>
    const LAST_ORDER_KEY = 'elevatefit_last_order';

    function formatNumber(n) {
      return n.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
    }

    function escapeHtml(text) {
      return text.replace(/[&<>"']/g, m => ({
        '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'
      }[m]));
    }

    document.addEventListener('DOMContentLoaded', () => {
      const data = localStorage.getItem(LAST_ORDER_KEY);
      if (!data) {
        // No recent order
        window.location.href = "index.html";
        return;
      }

      const order = JSON.parse(data);
      const container = document.getElementById('order-details');
      container.innerHTML = '';

      const orderId = `<div><span class="text-gray-400">Order ID:</span> <span class="font-medium">${order.id}</span></div>`;
      const paypalId = order.paypalOrderId ? `<div><span class="text-gray-400">PayPal ID:</span> <span class="font-medium">${order.paypalOrderId}</span></div>` : '';
      const date = `<div><span class="text-gray-400">Date:</span> ${new Date(order.timestamp).toLocaleString()}</div>`;
      const totalINR = `<div><span class="text-gray-400">Total (INR):</span> â‚¹${formatNumber(order.totalINR || 0)}</div>`;
      const totalUSD = `<div><span class="text-gray-400">Total (USD):</span> $${order.totalUSD || "0.00"}</div>`;

      container.insertAdjacentHTML('beforeend', orderId + paypalId + date + totalINR + totalUSD);

      if (order.items && order.items.length) {
        const itemHeader = `<h3 class="mt-4 font-semibold border-b border-gray-700 pb-1">Items Purchased</h3>`;
        container.insertAdjacentHTML('beforeend', itemHeader);
        order.items.forEach(it => {
          const item = document.createElement('div');
          item.className = 'flex justify-between border-b border-gray-700 py-2';
          item.innerHTML = `
            <div class="text-gray-300">${escapeHtml(it.name)} <span class="text-sm text-gray-500">x${it.qty}</span></div>
            <div class="text-gray-400">â‚¹${formatNumber(it.price * it.qty)}</div>
          `;
          container.appendChild(item);
        });
      }

      // Optionally clear order history after display
      localStorage.removeItem(LAST_ORDER_KEY);
    });
  </script>

</body>
</html>
